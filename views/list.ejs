<!DOCTYPE html>
<html>

<head>
    <title>Registrations - APS Dashboard</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </style>
    <!-- Bootstrap 3.3.6 -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet"></link>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Theme style -->
    <link href="/static/css/AdminLTE.min.css" rel="stylesheet"></link>
    <!-- AdminLTE Skins. Choose a skin from the css/skins folder instead of downloading all of them to reduce the load. -->
    <link href="/static/css/skins/_all-skins.min.css" rel="stylesheet"></link>
    <!-- iCheck -->
    <link href="/static/plugins/iCheck/flat/blue.css" rel="stylesheet"></link>
    <!-- Morris chart -->
    <link href="/static/plugins/morris/morris.css" rel="stylesheet"></link>
    <!-- jvectormap -->
    <link href="/static/plugins/jvectormap/jquery-jvectormap-1.2.2.css" rel="stylesheet"></link>
    <!-- Date Picker -->
    <link href="/static/plugins/datepicker/datepicker3.css" rel="stylesheet"></link>
    <!-- Daterange picker -->
    <link href="/static/plugins/daterangepicker/daterangepicker.css" rel="stylesheet"></link>
    <!-- bootstrap wysihtml5 - text editor -->
    <link href="/static/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css" rel="stylesheet"></link>
    <!-- Flask-admin admin styles -->
    <link href="/admin/static/admin/css/bootstrap3/admin.css?v=1.1.1" rel="stylesheet">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
    <script>
        $('select').selectpicker();
        $('.selectpicker').selectpicker('deselectAll');
        $('.selectpicker').selectpicker('selectAll');
    </script>










    <link href="/admin/static/vendor/select2/select2.css?v=3.5.2" rel="stylesheet">
    <link href="/admin/static/vendor/select2/select2-bootstrap3.css?v=1.4.6" rel="stylesheet">
    <link href="/admin/static/vendor/bootstrap-daterangepicker/daterangepicker-bs3.css?v=1.3.22" rel="stylesheet">



    <style>
        .dataTables_filter {
            text-align: right;
        }
    </style>
    <style>
        tr:hover {
            cursor: pointer;
            background-color: aliceblue;
        }
    </style>



</head>

<body class="hold-transition skin-blue sidebar-mini">



    <!-- TOP NAVBAR -->
    <div class="wrapper">

        <header class="main-header">
            <!-- Logo -->

            <a href="/admin" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini"><img src= "/static/aps-logo.png" height=50 width=50 /></span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg"><b>APS Group</b></span>
            </a>


            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top">
                <!-- Sidebar toggle button-->
                <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                    <span class="sr-only">Toggle navigation</span>
                </a>

                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">
                        <!-- Control Sidebar Toggle Button -->
                        <li>
                            <a href="#" data-toggle="control-sidebar"><i class="fa fa-gears"></i></a>
                        </li>
                        <li>


                            <!-- User Account: style can be found in dropdown.less -->

                            <li class="dropdown user user-menu">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="fa fa-user-circle" style="color: white; font-size: 1.4em;"></i>
                                    <span class="hidden-xs">
       
<%= nameunique %>
       
   </span>
                                </a>
                                <ul class="dropdown-menu">
                                    <!-- User image -->
                                    <li class="user-header">
                                        <i class="fa fa-user-circle" style="color: white; font-size: 7em;"></i>
                                        <p>

                                            <%= nameunique %>

                                                <br>
                                        </p>
                                        <p>
                                            <%= roleunique %>
                                        </p>
                                    </li>
                                    <!-- Menu Body -->
                                    <li class="user-body">
                                        <!-- /.row -->
                                    </li>
                                    <!-- Menu Footer-->
                                    <li class="user-footer">

                                        <div class="pull-right">
                                            <a href="/admin/logout/" class="btn btn-default btn-flat">Sign out</a>
                                        </div>
                                    </li>
                                </ul>
                            </li>




                        </li>
                    </ul>


                    <ul class="nav navbar-nav navbar-right">




                    </ul>


                </div>
            </nav>
        </header>
        <!-- / TOP NAVBAR -->

        <!-- LEFT MENU -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">
                <!-- Sidebar user panel -->
                <div class="user-panel">
                    <div class="pull-left image">
                        <i class="fa fa-user-circle" style="color: white; font-size: 2.5em;"></i>
                    </div>
                    <div class="pull-left info">
                        <p>
                            <%= nameunique %>

                        </p>
                        <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
                    </div>
                </div>
                <!-- search form -->
                <!-- <form action="#" method="get" class="sidebar-form">
                    <div class="input-group">
                        <input type="text" name="q" class="form-control" placeholder="Search...">
                        <span class="input-group-btn">
            <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i>
            </button>
          </span>
                    </div>
                </form> -->
                <!-- /.search form -->
                <!-- sidebar menu: : style can be found in sidebar.less -->
                <ul class="sidebar-menu">
                    <li class="header">MAIN NAVIGATION</li>



                    <li>
                        <a href="/admin/">Home</a>
                    </li>
                    <% if(roleunique === 'ADMIN') {%>
                        <li>
                            <a href="/admin/role/">


                                <i class="fa fa-server"></i> Roles

                            </a>
                        </li>
                        <li>
                            <a href="/admin/user/">


                                <i class="fa fa-users"></i> Users

                            </a>
                        </li>
                        <li>
                            <a href="/admin/course">


                                <i class="fa fa-book"></i> Courses

                            </a>
                        </li>
                        <li>
                            <a href="/admin/college/">


                                <i class="fa fa-graduation-cap"></i> College

                            </a>
                        </li>
                        <%}%>
                            <li class="active">
                                <a href="/admin/registeration/">


                                    <i class="fa fa-book"></i> Registrations

                                </a>
                            </li>
                            <li>
                                <a href="/admin/survey/">


                                    <i class="fa fa-book"></i> Survey

                                </a>
                            </li>



                </ul>
            </section>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content color white-->
        <div class="content-wrapper">

















            <ul class="nav nav-tabs">
                <li class="active">
                    <a href="/admin/registeration/">List</a>
                </li>
                <li>
                    <a href="/admin/registeration/create/">Create</a>
                </li>
                <li>
                    <a href="/admin/registeration/edit">Edit</a>
                </li>
                <li>
                    <a href="/admin/registeration/csv">Export All</a>
                </li>
                <li class="dropdown">

                    <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)">
                        Add Filter<b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu field-filters">

                        <li>
                            <a href="javascript:void(0)" class="filter" onclick="course()">Course</a>
                        </li>

                        <li>
                            <a href="javascript:void(0)" class="filter" onclick="college()">College</a>
                        </li>

                        <li>
                            <a href="javascript:void(0)" class="filter" onclick="date()">Date</a>
                        </li>

                    </ul>

                </li>
            </ul>
            <section class="content">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="box">
                            <div class="box-header">
                                <h3 class="box-title">Registrations</h3>
                            </div>
                            <!-- /.box-header -->
                            <div class="box-body table-responsive">
                                <form action="/admin/registeration/filter" method="POST" class="course" style="display: none;">
                                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                                    <label for="course">Course:</label>
                                    <select name="course" id="course">
                                        <% courses.forEach(c => { %>
                                            <option value="<%= c.courseName %>"><%= c.courseName %></option>
                                       <% }) %>
                                    </select>
                                    <button type="submit">Submit</button>
                                </form>
                                <form action="/admin/registeration/filter" method="POST" class="college" style="display: none;">
                                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                                    <label for="college">College:</label>
                                    <select name="college" id="college">
                                        <% colleges.forEach(c => { %>
                                            <option value="<%= c.collegeName %>"><%= c.collegeName %></option>
                                       <% }) %>
                                    </select>
                                    <button type="submit">Submit</button>
                                </form>
                                <form action="/admin/registeration/filter" method="POST" class="date" style="display: none;">
                                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                                    <label for="sdate">Start Date</label>
                                    <input type="date" name="sdate">
                                    <label for="edate">End Date</label>
                                    <input type="date" name="edate">
                                    <button type="submit">Submit</button>
                                </form>
                                <table id="example1" class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th>Email</th>
                                            <th>Name</th>
                                            <th>Contact No.</th>
                                            <th>Courses</th>
                                            <th>College</th>
                                            <th>Date of Birth</th>
                                            <th>Address</th>
                                            <th>Payment Status</th>
                                            <th>Order ID</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% if(!users) {%>
                                            <tr>
                                                <td>
                                                    No users
                                                </td>
                                            </tr>
                                            <%} else { %>
                                                <% users.forEach(u => { %>
                                                    <span>
                                                        <input type="hidden" name="_id" id="">
                                                    <tr onclick="clicked('<%= u._id %>')">
                                                        <td>
                                                            <%= u.email %>
                                                        </td>
                                                        <td>
                                                            <%= u.name %>
                                                        </td>
                                                        <td>
                                                            <%= u.contact %>
                                                        </td>
                                                        <td>
                                                            <% u.courses.forEach(e => { %>
                                                                <%= e %> <br>
                                                                    <% }) %>
                                                        </td>
                                                        <td>
                                                            <%= u.college %>
                                                        </td>
                                                        <td><% if(u.dob){ %>
                                                            <%= u.dob.toString().substring(4,15) %>
                                                            <% } %>
                                                        </td>
                                                        <td><%= u.address %></td>
                                                        <% if(u.razorpay_order_id) {%>
                                                            <td>Success-₹<%= u.amount %></td>
                                                        <%} else {%>
                                                            <td>Not Paid</td>
                                                            <% } %>
                                                            <td><%= u.order_id %></td>
                                                    </tr>
                                                </span>
                                                    <% }) %>
                                    </tbody>
                                </table>
                                <button class="buttonexp" style="display: block; margin: auto;">Export</button>
                            </div>
                            <!-- /.box-body -->
                        </div>
                    </div>
                </div>
        </div>
        <% } %>
            </section>






            <button class="buttonexp">W</button>




    </div>
    <!-- / Content Wrapper. color white -->

    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">
        <!-- Create the tabs -->
        <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
            <li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i class="fa fa-cog"></i></a></li>
        </ul>
        <!-- Tab panes -->
        <div class="tab-content">
            <!-- Stats tab content -->
            <!-- /.tab-pane -->
            <!-- Settings tab content -->
            <div class="tab-pane" id="control-sidebar-settings-tab">
                </a>
                </li>
                </ul>
            </div>
            <!-- /.tab-pane -->
        </div>
    </aside>
    <!-- /.control-sidebar -->
    <!-- Add the sidebar's background. This div must be placed
        immediately after the control sidebar -->
    <div class="control-sidebar-bg"></div>

    <footer class="main-footer">
        <strong>Copyright &copy; 2020 <a>SoftEra Inc.</a></strong> - All rights reserved.
        <div class="pull-right hidden-xs">
        </div>
    </footer>


    </div>
    <!-- ./wrapper -->
    <script src="/static/plugins/jQuery/jquery-2.2.3.min.js"></script>
    <!-- jQuery UI 1.11.4 -->
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
        $.widget.bridge('uibutton', $.ui.button);
    </script>
    <!-- Bootstrap 3.3.6 -->
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/admin/static/vendor/select2/select2.min.js?v=3.5.2" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="/static/plugins/morris/morris.min.js"></script>
    <script src="/static/plugins/sparkline/jquery.sparkline.min.js"></script>
    <script src="/static/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
    <script src="/static/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
    <script src="/static/plugins/knob/jquery.knob.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
    <script src="/static/plugins/daterangepicker/daterangepicker.js"></script>
    <script src="/static/plugins/datepicker/bootstrap-datepicker.js"></script>
    <script src="/static/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
    <script src="/static/plugins/slimScroll/jquery.slimscroll.min.js"></script>
    <script src="/static/plugins/fastclick/fastclick.js"></script>
    <script src="/static/js/app.min.js"></script>
    <script src="/admin/static/vendor/bootstrap-daterangepicker/daterangepicker.js?v=1.3.22"></script>
    <script src="/admin/static/admin/js/form.js?v=1.0.1"></script>
    <script src="/js/plugins/datatables/jquery.dataTables.js" type="text/javascript"></script>
    <script src="/js/plugins/datatables/dataTables.bootstrap.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function() {
            $("#example1").dataTable({
                "bSort": false
            });
            $('#example2').dataTable({
                "bPaginate": true,
                "bLengthChange": false,
                "bFilter": false,
                "bSort": true,
                "bInfo": true,
                "bAutoWidth": false
            });
        });
    </script>
    <script>
        function clicked(u) {
            location.replace(`/admin/registeration/edit/${u}`);
        }
    </script>
    <script>
        function course() {
            document.querySelector('.course').style.display = "block";
            document.querySelector('.college').style.display = "none";
            document.querySelector('.date').style.display = "none";
        }

        function college() {
            document.querySelector('.college').style.display = "block";
            document.querySelector('.course').style.display = "none";
            document.querySelector('.date').style.display = "none";
        }

        function date() {
            document.querySelector('.college').style.display = "none";
            document.querySelector('.course').style.display = "none";
            document.querySelector('.date').style.display = "block";
        }
    </script>
    <script src="/table/src/jquery.table2excel.js"></script>
    <script>
        $(".buttonexp").click(function() {
            console.log('pppp')
            $("#example1").table2excel({
                // exclude CSS class
                exclude: ".noExl",
                name: "Data",
                filename: "Data", //do not include extension
                fileext: ".xls" // file extension
            });
        });
    </script>
</body>

</html>